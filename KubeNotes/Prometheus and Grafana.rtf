Prometheus is open source monitoring tools.
We can monitor db servers also.

Prometheus collect data from various cluster based on pull mechanism  time series. It sends alerts also to email, teams etc.
It collects and stores data in persistent volumes.

…………………………….…………………………….…………………………….…………………………….…………………………….

Install Helm : 
1. curl -O https://get.helm.sh/helm-v3.16.2-linux-amd64.tar.gz

2. tar xvf helm-v3.16.2-linux-amd64.tar.gz

3. sudo mv linux-amd64/helm /usr/local/bin

4. rm helm-v3.16.2-linux-amd64.tar.gz

5. rm -rf linux-amd64

6. helm version


…………………………….…………………………….…………………………….…………………………….…………………………….

Helm Charts:

helm repo add stable https://charts.helm.sh/stable

# Add prometheus Helm repo
helm repo add prometheus-community https://prometheus-community.github.io/helm-charts


# helm repo update

# helm install prometheus prometheus-community/prometheus
 
This will give some commands:

Get the Prometheus server URL by running these commands in the same shell:
  export POD_NAME=$(kubectl get pods --namespace default -l "app.kubernetes.io/name=prometheus,app.kubernetes.io/instance=prometheus" -o jsonpath="{.items[0].metadata.name}")
  kubectl --namespace default port-forward $POD_NAME 9090


The Prometheus alertmanager can be accessed via port 9093 on the following DNS name from within your cluster:
prometheus-alertmanager.default.svc.cluster.local

The Prometheus PushGateway can be accessed via port 9091 on the following DNS name from within your cluster:
prometheus-prometheus-pushgateway.default.svc.cluster.local


Get the PushGateway URL by running these commands in the same shell:
  export POD_NAME=$(kubectl get pods --namespace default -l "app=prometheus-pushgateway,component=pushgateway" -o jsonpath="{.items[0].metadata.name}")
  kubectl --namespace default port-forward $POD_NAME 9091


# Kubectl get pods. Prometheus pods will be shown 

KubeState Metrics:

Kube-state-metrics provides insights into the state of your Kubernetes cluster by exposing metrics related to various objects like deployments, pods, services, and mor

Create Prometheus namespace
kubectl create namespace prometheus

helm install stable prometheus-community/kube-prometheus-stack -n prometheus

kubectl get pvc. This will show pending servers which has not run.





To Remove helm:

Helm list 
Helm delete prometheus
Helm repo list
Helm repo remove ()

helm repo add prometheus-community https://prometheus-community.github.io/helm-charts

helm repo update


helm install monitoring prometheus-community/kube-prometheus-stack

Kubectl get pods.

Kubectl get events

Kubectl describe pod  (  )



Events:
  Type     Reason            Age                    From               Message
  ----     ------            ----                   ----               -------
  Warning  FailedScheduling  2m28s (x2 over 7m47s)  default-scheduler  0/2 nodes are available: 1 node(s) didn't have free ports for the requested pod ports, 1 node(s) didn't satisfy plugin(s) [NodeAffinity]. preemption: 0/2 nodes are available: 1 No preemption victims found for incoming pod, 1 Preemption is not helpful for scheduling.









